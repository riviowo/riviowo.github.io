<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EryVanta</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; margin: 24px; line-height: 1.5; }
    .wrap { max-width: 900px; }
    .top { display: flex; align-items: center; justify-content: space-between; gap: 12px; flex-wrap: wrap; }
    .brand { font-size: 22px; font-weight: 700; }
    .tabs { display: flex; gap: 10px; }
    .tab { padding: 8px 12px; border: 1px solid #ddd; border-radius: 10px; cursor: pointer; user-select: none; }
    .tab.active { background: #f4f4f4; }
    .card { border: 1px solid #ddd; border-radius: 14px; padding: 16px; margin-top: 14px; }
    .row { display: grid; grid-template-columns: 180px 1fr; gap: 10px; margin: 6px 0; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; word-break: break-all; }
    .btns { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px; }
    button { padding: 10px 14px; border-radius: 10px; border: 1px solid #ccc; cursor: pointer; }
    button:disabled { opacity: 0.5; cursor: not-allowed; }
    .status { display:flex; align-items:center; gap:8px; }
    .dot { width:10px; height:10px; border-radius:50%; background:#bbb; }
    .dot.on { background:#22c55e; }
    .dot.off { background:#ef4444; }
    .view { display: none; }
    .view.active { display: block; }
    .note { color: #444; font-size: 14px; }
    .msg { margin-top: 8px; color:#111; }
    .warn { color:#8a3b00; font-size: 14px; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div class="brand">EryVanta</div>
      <div class="tabs">
        <div class="tab active" data-tab="home">Home</div>
        <div class="tab" data-tab="shop">Shop</div>
        <div class="tab" data-tab="account">Account</div>
      </div>
    </div>

    <div class="card">
      <h2 style="margin:0 0 8px 0;">Session</h2>
      <div class="status">
        <div id="dot" class="dot off"></div>
        <div id="status">Disconnected</div>
      </div>

      <div class="row"><div>Address</div><div id="addr" class="mono">-</div></div>
      <div class="row"><div>Chain</div><div id="chain" class="mono">-</div></div>
      <div class="row"><div>Balance (native)</div><div id="bal" class="mono">-</div></div>

      <div class="btns">
        <button id="btnConnect">Connect & Sign</button>
        <button id="btnLogout" disabled>Log Out</button>
      </div>

      <div class="warn">Always verify the recipient address in MetaMask before confirming a payment.</div>
    </div>

    <div class="card">
      <h2 style="margin:0 0 8px 0;">Quick Info</h2>
      <div class="note">
        This site is hosted on GitHub Pages (static hosting). It does not store usernames/passwords.
        Your “account” is your wallet address + signature.
        Membership activation is verified by checking the transaction on-chain.
        On-chain payments are public by design.
      </div>
    </div>

    <div id="view-home" class="card view active">
      <h2 style="margin:0 0 8px 0;">Home</h2>
      <div>Connect your wallet, sign in, then open the Shop tab to purchase a membership.</div>
    </div>

    <div id="view-shop" class="card view">
      <h2 style="margin:0 0 8px 0;">Shop</h2>

      <h3 style="margin:8px 0;">Membership</h3>
      <div>$1.00 (paid in POL on Polygon)</div>

      <div class="btns" style="margin-top:10px;">
        <button id="btnQuote">Refresh Quote</button>
        <button id="btnPay" disabled>Pay with MetaMask</button>
      </div>

      <div class="row"><div>Receiver</div><div id="receiver" class="mono">-</div></div>
      <div class="row"><div>Chainlink Price (USD per POL)</div><div id="price" class="mono">-</div></div>
      <div class="row"><div>Amount to Pay</div><div id="amountPol" class="mono">-</div></div>
      <div class="row"><div>Price Updated</div><div id="updatedAt" class="mono">-</div></div>

      <div class="note">If the network is not Polygon, the site will request a network switch to Polygon (chainId 0x89).</div>
      <div id="shopMsg" class="msg"></div>
    </div>

    <div id="view-account" class="card view">
      <h2 style="margin:0 0 8px 0;">Account</h2>
      <div class="row"><div>Membership Status</div><div id="mStatus" class="mono">-</div></div>
      <div class="row"><div>Last Payment Tx</div><div id="mTx" class="mono">-</div></div>
      <div class="row"><div>Verified On-Chain</div><div id="mVerified" class="mono">-</div></div>
      <div class="note">This demo stores the last successful payment txHash locally, then verifies it on-chain when you revisit.</div>
    </div>
  </div>

  <script src="./app.js"></script>
</body>
</html>
